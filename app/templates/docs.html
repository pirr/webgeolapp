{% extends "base.html" %}
{% block script %}
<script type="text/javascript">
$(document).ready( function() {
    $('.filter').multifilter()

       search();
       $('#pis').multiselect({
        selectAllValue: 'multiselect-all',
        includeSelectAllOption: true,
        enableFiltering: true,
        filterBehavior: 'text',
        filterPlaceholder: 'Найти',
        buttonWidth: '250px',
        nonSelectedText: 'Выбрать ПИ',
        selectAllText: 'Выбрать всё',
        allSelectedText: 'Всё',
        maxHeight: 200,
        checkboxName: 'multiselect[]',
        onChange: function(pi, checked) {
            var pis = $('#pis option:selected');
            var selected = [];
            $(pis).each(function(index, pi){
                selected.push($(this).val());
            });
            console.log(selected)
            $.ajax({
                url: '/docs_table',
                type: 'POST',
                data: JSON.stringify({pis_id: selected}),
                success: function(response) {
                    console.log(response)
            }
        });
    }
});   
});






</script>
<link rel="stylesheet" href="/static/ext/bootstrap/multiple_select/css/bootstrap-multiselect.css" type="text/css"/>
<script src="/static/ext/bootstrap/multiple_select/js/bootstrap-multiselect.js" type="text/javascript"></script>
<script src="/static/ext/bootstrap/multifilter-master/multifilter.js" type="text/javascript"></script>
{% endblock %}
{% block body %}
<h2>Документы</h2>
<div id='filters'>
    <table class="table table-bordered">
        <tr>
            <td>
            <input id="searchname" type="text" 
            onkeyup="search()" class="filter" placeholder="Найти по названию"/>
            </td>
            <td>
            <select id="pis" class="filter" multiple="multiple" name="select[]">
            {% for pi in dic_pi %}
                <option value="{{pi.pi_id}}">{{pi.pi}}</option>
            {% endfor %}
            </select>
            </td>
            </td>
        </tr>
    </table>
</div>
<div id="search_results"></div>
{% endblock %}

